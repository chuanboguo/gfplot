<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Age and length frequency weighting — weight_comps • gfplot</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Age and length frequency weighting — weight_comps" />

<meta property="og:description" content="In general, you shouldn't have to use these functions directly. However, they
are exposed to the user in case you need the flexibility of using them
yourself and as a place to hold documentation about the weighting schemes.
These functions weight age or length frequencies. tidy_comps_commercial()
and tidy_comps_survey() join the necessary data for commercial or survey
samples, respectively, and format it for weighting. weight_comps() does the
actual weighting based on the output from the tidy_* functions." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gfplot</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/commercial-cpue-index.html">Commercial CPUE</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/seananderson/gfplot">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Age and length frequency weighting</h1>
    <small class="dont-index">Source: <a href='https://github.com/seananderson/gfplot/blob/master/R/weight-props.R'><code>R/weight-props.R</code></a></small>
    <div class="hidden name"><code>weight_comps.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>In general, you shouldn't have to use these functions directly. However, they
are exposed to the user in case you need the flexibility of using them
yourself and as a place to hold documentation about the weighting schemes.
These functions weight age or length frequencies. <code>tidy_comps_commercial()</code>
and <code>tidy_comps_survey()</code> join the necessary data for commercial or survey
samples, respectively, and format it for weighting. <code>weight_comps()</code> does the
actual weighting based on the output from the <code>tidy_*</code> functions.</p>
    
    </div>

    <pre class="usage"><span class='fu'>tidy_comps_commercial</span>(<span class='no'>specimen_dat</span>, <span class='no'>catch_dat</span>, <span class='no'>value</span>, <span class='kw'>bin_size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>tidy_comps_survey</span>(<span class='no'>specimen_dat</span>, <span class='no'>survey_tows</span>, <span class='no'>value</span>, <span class='kw'>bin_size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>weight_comps</span>(<span class='no'>dat</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>specimen_dat</th>
      <td><p>Specimen data. E.g. from <code><a href='get.html'>get_comm_samples()</a></code> for
commercial data or <code><a href='get.html'>get_survey_samples()</a></code> for survey data.</p></td>
    </tr>
    <tr>
      <th>catch_dat</th>
      <td><p>Catch data. E.g. from <code><a href='get.html'>get_catch()</a></code>.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>The <strong>unquoted</strong> column name with the values to re-weight
(e.g. <code>age</code> or <code>length</code>).</p></td>
    </tr>
    <tr>
      <th>bin_size</th>
      <td><p>The binning size (likely only used for lengths).</p></td>
    </tr>
    <tr>
      <th>survey_tows</th>
      <td><p>Survey tow data. E.g. from <code><a href='get.html'>get_survey_samples()</a></code>.</p></td>
    </tr>
    <tr>
      <th>dat</th>
      <td><p>A properly formatted data frame such the output from
<code>tidy_comps_survey()</code> or <code>tidy_comps_commercial()</code>. See details.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The input data frame to <code>weight_comps()</code> must have columns in the
following order:</p><ol>
<li><p>year</p></li>
<li><p>weighting unit ID (e.g. trip ID or sample ID)</p></li>
<li><p>grouping variable for first weighting (e.g. quarter or stratum)</p></li>
<li><p>value of weighting variable (e.g. age or length bin)</p></li>
<li><p>frequency of that weighting variable (e.g. frequency of that age or
length bin)</p></li>
<li><p>numerator in first weighting (e.g. sample catch weight or density)</p></li>
<li><p>denominator in first weighting (e.g. quarter catch weight or total
stratum density)</p></li>
<li><p>numerator in second weighting (e.g. catch that quarter or stratum area)</p></li>
<li><p>denominator in second weighting (e.g. catch that year or total survey
area)</p></li>
</ol>
    <p><code>tidy_comps_commercial()</code> and <code>tidy_comps_survey()</code> both output data frames
in this format and so you ordinarily would not have to worry about this. The
names of the columns do not matter, only their contents. The data frame
should contain these columns and only these columns.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Page 161 of Kendra R. Holt, Paul J. Starr, Rowan Haigh, and Brian Krishka.
2016. Stock Assessment and Harvest Advice for Rock Sole (Lepidopsetta spp.)
in British Columbia. CSAS Res. Doc. 2016/009.
<a href='http://www.dfo-mpo.gc.ca/csas-sccs/Publications/ResDocs-DocRech/2016/2016_009-eng.html'>Link</a>
<a href='http://waves-vagues.dfo-mpo.gc.ca/Library/363948.pdf'>PDF</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other age- and length-frequency functions: <code><a href='plot_ages.html'>plot_ages</a></code>,
  <code><a href='plot_lengths.html'>plot_lengths</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='no'>species</span> <span class='kw'>&lt;-</span> <span class='st'>"redstripe rockfish"</span>

<span class='co'>## Surveys:</span>
<span class='co'>## ssid = 1 is Queen Charlotte Sound Synoptic Survey:</span>
<span class='co'># rs_survey_samples &lt;- get_survey_samples(species, ssid = 1)</span>
<span class='co'># rs_survey_sets &lt;- get_survey_sets(species, ssid = 1)</span>

<span class='no'>surv_lengths</span> <span class='kw'>&lt;-</span> <span class='fu'>tidy_comps_survey</span>(<span class='no'>rs_survey_samples</span>, <span class='no'>rs_survey_sets</span>,
  <span class='kw'>value</span> <span class='kw'>=</span> <span class='no'>length</span>, <span class='kw'>bin_size</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>surv_lengths</span>
<span class='fu'>weight_comps</span>(<span class='no'>surv_lengths</span>)

<span class='no'>surv_ages</span> <span class='kw'>&lt;-</span> <span class='fu'>tidy_comps_survey</span>(<span class='no'>rs_survey_samples</span>, <span class='no'>rs_survey_sets</span>, <span class='kw'>value</span> <span class='kw'>=</span> <span class='no'>age</span>)
<span class='no'>surv_ages</span>
<span class='fu'>weight_comps</span>(<span class='no'>surv_ages</span>)

<span class='co'>## Commercial:</span>
<span class='co'># rs_comm_samples &lt;- get_comm_samples(species)</span>
<span class='co'># rs_catch &lt;- get_catch(species)</span>

<span class='no'>com_lengths</span> <span class='kw'>&lt;-</span> <span class='fu'>tidy_comps_commercial</span>(<span class='no'>rs_comm_samples</span>, <span class='no'>rs_catch</span>,
  <span class='kw'>value</span> <span class='kw'>=</span> <span class='no'>length</span>, <span class='kw'>bin_size</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>com_lengths</span>
<span class='fu'>weight_comps</span>(<span class='no'>com_lengths</span>)

<span class='no'>com_ages</span> <span class='kw'>&lt;-</span> <span class='fu'>tidy_comps_commercial</span>(<span class='no'>rs_comm_samples</span>, <span class='no'>rs_catch</span>,
  <span class='kw'>value</span> <span class='kw'>=</span> <span class='no'>age</span>)
<span class='no'>com_ages</span>
<span class='fu'>weight_comps</span>(<span class='no'>com_ages</span>)

<span class='co'>## These functions are pipe (%&gt;%) friendly. E.g.:</span>
<span class='fu'>tidy_comps_survey</span>(<span class='no'>rs_survey_samples</span>, <span class='no'>rs_survey_sets</span>, <span class='kw'>value</span> <span class='kw'>=</span> <span class='no'>age</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>weight_comps</span>()
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sean Anderson, Elise Keppel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

